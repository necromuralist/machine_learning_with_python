<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Decision Tree Classification using the cancer data.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Decision Tree Classification | Machine Learning Studies</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="http://necromuralist.github.io/machine-learning-studies/posts/decision-tree-classification/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script><meta name="author" content="Brunhilde">
<link rel="prev" href="../Naive-Bayes-Classification/" title="Naive Bayes Classification" type="text/html">
<link rel="next" href="../california-housing-prices/" title="California Housing Prices" type="text/html">
<meta property="og:site_name" content="Machine Learning Studies">
<meta property="og:title" content="Decision Tree Classification">
<meta property="og:url" content="http://necromuralist.github.io/machine-learning-studies/posts/decision-tree-classification/">
<meta property="og:description" content="Decision Tree Classification using the cancer data.">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2017-07-17T16:41:00-07:00">
<meta property="article:tag" content="classification">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-default navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://necromuralist.github.io/machine-learning-studies/">

                <span id="blog-title">Machine Learning Studies</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="https://necromuralist.github.io/">The Cloistered Monkey</a>
                </li>
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>
                </li>
<li>
<a href="../../rss.xml">RSS feed</a>

                
            </li>
</ul>
<!-- Google custom search --><form method="get" action="https://www.google.com/search" class="navbar-form navbar-right" role="search">
<div class="form-group">
<input type="text" name="q" class="form-control" placeholder="Search">
</div>
<button type="submit" class="btn btn-primary">
	<span class="glyphicon glyphicon-search"></span>
</button>
<input type="hidden" name="sitesearch" value="http://necromuralist.github.io/machine-learning-studies/">
</form>
<!-- End of custom search -->


            <ul class="nav navbar-nav navbar-right">
<li>
    <a href="index.rst" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Decision Tree Classification</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                    <a href="../../authors/brunhilde/">Brunhilde</a>
            </span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2017-07-17T16:41:00-07:00" itemprop="datePublished" title="2017-07-17 16:41">2017-07-17 16:41</time></a></p>
            
        <p class="sourceline"><a href="index.rst" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<div class="section" id="imports">
<h2>1 Imports</h2>
<pre class="code python"><a name="rest_code_764203a372d54898b6b964a3ad06667d-1"></a><span class="kn">import</span> <span class="nn">graphviz</span>
<a name="rest_code_764203a372d54898b6b964a3ad06667d-2"></a><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="p">(</span>
<a name="rest_code_764203a372d54898b6b964a3ad06667d-3"></a>    <span class="n">DecisionTreeClassifier</span><span class="p">,</span>
<a name="rest_code_764203a372d54898b6b964a3ad06667d-4"></a>    <span class="n">export_graphviz</span><span class="p">,</span>
<a name="rest_code_764203a372d54898b6b964a3ad06667d-5"></a>    <span class="p">)</span>
<a name="rest_code_764203a372d54898b6b964a3ad06667d-6"></a><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<a name="rest_code_764203a372d54898b6b964a3ad06667d-7"></a><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_breast_cancer</span>
</pre>
<pre class="code python"><a name="rest_code_6f5c259b69d54e7a8d63f147524135dc-1"></a><span class="o">%</span> <span class="n">matplotlib</span> <span class="n">inline</span>
</pre>
</div>
<div class="section" id="the-data">
<h2>2 The Data</h2>
<pre class="code python"><a name="rest_code_5832a518a5874376b739bfa9634c9824-1"></a><span class="n">cancer</span> <span class="o">=</span> <span class="n">load_breast_cancer</span><span class="p">()</span>
<a name="rest_code_5832a518a5874376b739bfa9634c9824-2"></a><span class="k">print</span><span class="p">(</span><span class="n">cancer</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre>
<pre class="literal-block">
dict_keys(['DESCR', 'target_names', 'data', 'feature_names', 'target'])
</pre>
<pre class="code python"><a name="rest_code_cbaa488eb6af40fdb66c1fd05832a96a-1"></a><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">cancer</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
<a name="rest_code_cbaa488eb6af40fdb66c1fd05832a96a-2"></a>                                                    <span class="n">cancer</span><span class="o">.</span><span class="n">target</span><span class="p">,</span>
<a name="rest_code_cbaa488eb6af40fdb66c1fd05832a96a-3"></a>                                                    <span class="n">stratify</span><span class="o">=</span><span class="n">cancer</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
</pre>
</div>
<div class="section" id="the-model">
<h2>3 The Model</h2>
<pre class="code python"><a name="rest_code_0b3882ea21484784956111318de886c7-1"></a><span class="k">def</span> <span class="nf">build_tree</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
<a name="rest_code_0b3882ea21484784956111318de886c7-2"></a>    <span class="n">tree</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="p">)</span>
<a name="rest_code_0b3882ea21484784956111318de886c7-3"></a>    <span class="n">tree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a name="rest_code_0b3882ea21484784956111318de886c7-4"></a>    <span class="k">print</span><span class="p">(</span><span class="s2">"Max Depth: {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">max_depth</span><span class="p">))</span>
<a name="rest_code_0b3882ea21484784956111318de886c7-5"></a>    <span class="k">print</span><span class="p">(</span><span class="s2">"Training Accuracy: {0:.2f}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)))</span>
<a name="rest_code_0b3882ea21484784956111318de886c7-6"></a>    <span class="k">print</span><span class="p">(</span><span class="s2">"Testing Accuracy: {0:.2f}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>
<a name="rest_code_0b3882ea21484784956111318de886c7-7"></a>    <span class="k">print</span><span class="p">()</span>
<a name="rest_code_0b3882ea21484784956111318de886c7-8"></a>    <span class="k">return</span>
<a name="rest_code_0b3882ea21484784956111318de886c7-9"></a>
<a name="rest_code_0b3882ea21484784956111318de886c7-10"></a><span class="n">build_tree</span><span class="p">()</span>
</pre>
<pre class="literal-block">
Max Depth: None
Training Accuracy: 1.00
Testing Accuracy: 0.93
</pre>
<p>It looks like the tree is overfitting the training data. This is because the default tree will have leaf nodes that match each case in the training data set. Limiting the depth of the tree will help with this.</p>
<pre class="code python"><a name="rest_code_e7f764e02f184ec1878f645ed7735953-1"></a><span class="k">for</span> <span class="n">depth</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
<a name="rest_code_e7f764e02f184ec1878f645ed7735953-2"></a>    <span class="n">build_tree</span><span class="p">(</span><span class="n">depth</span><span class="p">)</span>
</pre>
<pre class="literal-block">
Max Depth: 1
Training Accuracy: 0.92
Testing Accuracy: 0.90

Max Depth: 2
Training Accuracy: 0.95
Testing Accuracy: 0.92

Max Depth: 3
Training Accuracy: 0.96
Testing Accuracy: 0.92

Max Depth: 4
Training Accuracy: 0.98
Testing Accuracy: 0.91
</pre>
<p>The book was able to get 95% accuracy for the training data, although I don't seem to be able to do better than 92%.</p>
</div>
<div class="section" id="visualizing-the-tree">
<h2>4 Visualizing The Tree</h2>
<pre class="code python"><a name="rest_code_9c96bd96c6044f9f87e5576de6278e3c-1"></a><span class="n">tree</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a name="rest_code_9c96bd96c6044f9f87e5576de6278e3c-2"></a><span class="n">tree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a name="rest_code_9c96bd96c6044f9f87e5576de6278e3c-3"></a><span class="n">export_graphviz</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">out_file</span><span class="o">=</span><span class="s2">"tree.dot"</span><span class="p">,</span> <span class="n">class_names</span><span class="o">=</span><span class="n">cancer</span><span class="o">.</span><span class="n">target_names</span><span class="p">,</span>
<a name="rest_code_9c96bd96c6044f9f87e5576de6278e3c-4"></a>                <span class="n">feature_names</span><span class="o">=</span><span class="n">cancer</span><span class="o">.</span><span class="n">feature_names</span><span class="p">,</span> <span class="n">impurity</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<a name="rest_code_9c96bd96c6044f9f87e5576de6278e3c-5"></a>                <span class="n">filled</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre>
<pre class="code python"><a name="rest_code_d97f6191f6a14637810ade52ad381289-1"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"tree.dot"</span><span class="p">)</span> <span class="k">as</span> <span class="n">reader</span><span class="p">:</span>
<a name="rest_code_d97f6191f6a14637810ade52ad381289-2"></a>    <span class="n">dot_file</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<a name="rest_code_d97f6191f6a14637810ade52ad381289-3"></a>
<a name="rest_code_d97f6191f6a14637810ade52ad381289-4"></a><span class="n">graphviz</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="n">dot_file</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s2">"png"</span><span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">"tree"</span><span class="p">)</span>
</pre>
<img alt="tree.png" src="tree.png">
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/classification/" rel="tag">classification</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../Naive-Bayes-Classification/" rel="prev" title="Naive Bayes Classification">Previous post</a>
            </li>
            <li class="next">
                <a href="../california-housing-prices/" rel="next" title="California Housing Prices">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents Â© 2018         <a href="mailto:necromuralist@gmail.com">necromuralist</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png"></a><br>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
